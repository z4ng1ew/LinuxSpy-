#!/usr/bin/env bash

# === БЛОК 1: ПРОВЕРКА ЗАВИСИМОСТЕЙ ===
check_dependencies() {
    # Создаем пустой массив (список) для потерянных команд.
    local missing=()
    
    # Перебираем список важных программ
    for cmd in ip awk free df date hostname; do
        # command -v: Проверяет, знает ли система такую команду.
        # &>/dev/null: "Молча" (все ошибки и вывод — в черную дыру).
        # || (ИЛИ): Если команды НЕТ, выполняем то, что справа.
        # missing+=("$cmd"): Добавляем имя потерянной команды в наш список.
        command -v "$cmd" &>/dev/null || missing+=("$cmd")
    done
    
    # ${#missing[@]} — считаем количество элементов в массиве.
    # -gt 0 — "Greater Than" (больше нуля).
    if [[ ${#missing[@]} -gt 0 ]]; then
        # >&2 — отправляем сообщение в поток ОШИБОК (stderr), а не обычного текста.
        # ${missing[*]} — выводим все элементы массива через пробел.
        echo "Ошибка: отсутствуют команды: ${missing[*]}" >&2
        exit 1 # Аварийный выход. Дальше скрипт не пойдет (благодаря set -e в main.sh).
    fi
}